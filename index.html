<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏´‡∏ô‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏õ‡∏±‡πà‡∏ô</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />

    <style>
        /* ‡πÉ‡∏ä‡πâ‡∏ü‡∏≠‡∏ô‡∏ï‡πå Prompt ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢‡πÅ‡∏•‡∏∞‡∏î‡∏π‡πÄ‡∏õ‡πá‡∏ô‡∏°‡∏∑‡∏≠‡∏≠‡∏≤‡∏ä‡∏µ‡∏û */
        @import url('https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;500;600&display=swap');
        
        body { 
            font-family: 'Prompt', sans-serif; 
            background-color: #f8f9fa; /* ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡πÄ‡∏ó‡∏≤‡∏≠‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏Å‡πÜ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ö‡∏≤‡∏¢‡∏ï‡∏≤ */
            color: #333;
            -webkit-font-smoothing: antialiased;
        }
        
        /* ‡∏ã‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
        .page-section { display: none; }
        .active-section { display: block; animation: fadeIn 0.4s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
        
        /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Map */
        #map { height: 250px; width: 100%; border-radius: 12px; z-index: 0; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }

        /* Animation Modal */
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        .animate-slide-up { animation: slideUp 0.3s cubic-bezier(0.16, 1, 0.3, 1); }

        /* Tab Active State */
        .tab-active {
            color: #16a34a; /* Green-600 */
            border-bottom: 2px solid #16a34a;
            background-color: rgba(22, 163, 74, 0.05);
        }
        .tab-inactive {
            color: #6b7280; /* Gray-500 */
            border-bottom: 2px solid transparent;
        }
    </style>
</head>
<body class="pb-28"> <div class="max-w-md mx-auto min-h-screen bg-white shadow-xl relative overflow-hidden sm:border-x sm:border-gray-100">

        <header class="bg-white sticky top-0 z-30 shadow-sm/50 backdrop-blur-md bg-opacity-95">
            <div class="px-5 py-4 flex items-center gap-4">
                <button onclick="if(!document.getElementById('page-menu').classList.contains('active-section')) showPage('menu')" class="w-10 h-10 rounded-full bg-gray-50 text-gray-600 flex items-center justify-center hover:bg-gray-100 transition shadow-sm">
                    <i class="fa-solid fa-arrow-left"></i>
                </button>
                <div class="flex-1">
                    <h1 class="font-semibold text-xl text-gray-800 tracking-tight">‡∏´‡∏ô‡∏∏‡πà‡∏°‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏õ‡∏±‡πà‡∏ô</h1>
                    <div class="flex items-center gap-1 text-xs text-green-600 font-medium">
                        <i class="fa-solid fa-check-circle"></i>
                        <span>Verified Store</span>
                        <span class="text-gray-300 mx-1">|</span>
                        <span class="text-gray-500">‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ 3 ‡∏Å‡∏°. ‡πÅ‡∏£‡∏Å</span>
                    </div>
                </div>
                <div class="w-10 h-10 rounded-full bg-gray-50 text-gray-400 flex items-center justify-center hover:text-green-600 transition cursor-pointer shadow-sm">
                    <i class="fa-solid fa-share-nodes"></i>
                </div>
            </div>
            
            <div id="category-tabs" class="flex px-2 border-b border-gray-100">
                <div onclick="switchTab('recommend')" id="tab-recommend" class="flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-active">
                    ‡πÄ‡∏°‡∏ô‡∏π‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥
                </div>
                <div onclick="switchTab('promotion')" id="tab-promotion" class="flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-inactive">
                    ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô
                </div>
            </div>
        </header>

        <section id="page-menu" class="page-section active-section">
            <div class="px-5 py-4 bg-gray-50 border-b border-gray-100 flex justify-between items-end">
                <h2 id="menu-heading" class="font-semibold text-lg text-gray-700">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï üî•</h2>
                <span class="text-xs text-gray-400">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏£‡πà‡∏≠‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢</span>
            </div>

            <div id="menu-list" class="pb-4">
                </div>
        </section>

        <section id="page-cart" class="page-section bg-gray-50 min-h-screen">
            <div class="bg-white px-5 py-4 shadow-sm mb-2">
                <h2 class="text-xl font-semibold text-gray-800">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</h2>
                <p class="text-sm text-gray-400">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</p>
            </div>

            <div id="cart-items" class="bg-white p-5 mb-3 space-y-4">
                <p class="text-gray-400 text-center py-10 font-light">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</p>
            </div>
            
            <div class="bg-white p-5 mb-24 space-y-3">
                <div class="flex justify-between text-gray-500 text-sm">
                    <span>‡∏Ñ‡πà‡∏≤‡∏≠‡∏≤‡∏´‡∏≤‡∏£</span>
                    <span id="subtotal-price">0 ‡∏ö‡∏≤‡∏ó</span>
                </div>
                <div class="flex justify-between text-gray-500 text-sm">
                    <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</span>
                    <span class="text-green-600">‡∏ü‡∏£‡∏µ</span>
                </div>
                <div class="border-t border-dashed my-2"></div>
                <div class="flex justify-between font-semibold text-xl text-gray-800">
                    <span>‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏™‡∏∏‡∏ó‡∏ò‡∏¥</span>
                    <span id="total-price-cart" class="text-green-600">0 ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>
        </section>

        <section id="page-checkout" class="page-section bg-white min-h-screen px-5 py-6">
            <h2 class="text-xl font-semibold mb-6 text-gray-800">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h2>
            
            <div class="space-y-5">
                <div class="space-y-4">
                    <div class="relative">
                        <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-medium">‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö</label>
                        <input type="text" id="cust-name" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500 transition" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
                    </div>
                    
                    <div class="relative">
                        <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-medium">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå</label>
                        <input type="tel" id="cust-phone" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500 transition" placeholder="‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠">
                    </div>

                    <div class="relative">
                        <label class="absolute -top-2 left-3 bg-white px-1 text-xs text-green-600 font-medium">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</label>
                        <textarea id="cust-address" class="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:border-green-500 focus:ring-1 focus:ring-green-500 transition" rows="2" placeholder="‡∏ö‡πâ‡∏≤‡∏ô‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà, ‡∏ã‡∏≠‡∏¢, ‡∏à‡∏∏‡∏î‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï"></textarea>
                    </div>
                </div>
                
                <div class="pt-2">
                    <div class="flex justify-between items-center mb-2">
                        <p class="text-sm font-semibold text-gray-700">üìç ‡∏õ‡∏±‡∏Å‡∏´‡∏°‡∏∏‡∏î‡∏à‡∏∏‡∏î‡∏™‡πà‡∏á</p>
                        <span class="text-xs text-gray-400 bg-gray-100 px-2 py-1 rounded">‡πÅ‡∏ï‡∏∞‡∏ó‡∏µ‡πà‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏´‡∏°‡∏∏‡∏î</span>
                    </div>
                    <div id="map"></div>
                    <input type="hidden" id="latlong">
                </div>

                <div class="bg-green-50 border border-green-100 rounded-xl p-5 text-center mt-6">
                    <p class="font-semibold text-gray-700 mb-3">‡∏™‡πÅ‡∏Å‡∏ô‡∏à‡πà‡∏≤‡∏¢‡∏ú‡πà‡∏≤‡∏ô QR Code</p>
                    <div class="bg-white p-2 inline-block rounded-lg shadow-sm border mb-3">
                        <img id="qr-image" src="" class="w-40 h-40 object-contain">
                    </div>
                    <p class="text-green-700 font-bold text-2xl" id="final-price-display">0 ‡∏ö‡∏≤‡∏ó</p>
                    <p class="text-xs text-gray-500 mt-1">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏ô‡∏ö‡∏™‡∏•‡∏¥‡∏õ‡πÉ‡∏ô‡πÑ‡∏•‡∏ô‡πå‡∏´‡∏•‡∏±‡∏á‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</p>
                </div>
            </div>
        </section>

        <div id="sticky-footer" class="fixed bottom-0 w-full max-w-md bg-white/90 backdrop-blur-md border-t border-gray-200 p-4 z-40 hidden shadow-[0_-4px_6px_-1px_rgba(0,0,0,0.05)]">
            
            <button id="btn-view-cart" onclick="showPage('cart')" class="w-full bg-green-600 text-white rounded-xl p-3.5 flex justify-between items-center shadow-lg shadow-green-200 hover:bg-green-700 hover:shadow-green-300 transition-all transform active:scale-[0.98]">
                <div class="flex items-center gap-3">
                    <div class="bg-white/20 backdrop-blur-sm text-white font-bold w-8 h-8 rounded-lg flex items-center justify-center text-sm" id="footer-count">0</div>
                    <div class="flex flex-col items-start leading-none">
                        <span class="font-semibold text-base">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤</span>
                        <span class="text-[10px] opacity-80 font-light">‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</span>
                    </div>
                </div>
                <span class="font-bold text-lg" id="footer-total">‡∏ø0</span>
            </button>

            <div id="btn-checkout-group" class="hidden flex gap-3 w-full">
                <button onclick="showPage('menu')" class="flex-1 bg-gray-100 text-gray-600 rounded-xl font-medium py-3.5 hover:bg-gray-200 transition">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                <button onclick="goToCheckout()" class="flex-[2] bg-green-600 text-white rounded-xl font-bold py-3.5 shadow-lg shadow-green-200 hover:bg-green-700 transition">‡∏™‡∏±‡πà‡∏á‡πÄ‡∏•‡∏¢</button>
            </div>

            <div id="btn-confirm-group" class="hidden flex gap-3 w-full">
                <button onclick="showPage('cart')" class="flex-1 bg-gray-100 text-gray-600 rounded-xl font-medium py-3.5 hover:bg-gray-200 transition">‡∏Å‡∏•‡∏±‡∏ö</button>
                <button onclick="confirmOrder()" class="flex-[2] bg-green-600 text-white rounded-xl font-bold py-3.5 shadow-lg shadow-green-200 hover:bg-green-700 transition">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô</button>
            </div>
        </div>

    </div>

    <div id="option-modal" class="fixed inset-0 bg-black/60 backdrop-blur-sm hidden flex justify-center items-end sm:items-center z-50 transition-opacity">
        <div class="bg-white w-full max-w-md rounded-t-3xl sm:rounded-2xl p-6 shadow-2xl animate-slide-up max-h-[85vh] flex flex-col">
            
            <div class="flex justify-between items-start mb-4 pb-2 border-b border-gray-50">
                <div>
                    <h3 id="modal-item-name" class="text-xl font-semibold text-gray-800 leading-tight">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏ô‡∏π</h3>
                    <p class="text-sm text-gray-400 font-light mt-1" id="modal-item-desc">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 text-xl bg-gray-50 w-8 h-8 rounded-full flex items-center justify-center hover:bg-gray-100 hover:text-gray-600 transition">&times;</button>
            </div>

            <div id="modal-options" class="flex-1 overflow-y-auto mb-4 pr-1 space-y-5 custom-scrollbar">
                </div>

            <div class="pt-2">
                <button onclick="confirmAddToCart()" class="w-full bg-green-600 text-white py-3.5 rounded-xl font-bold shadow-lg shadow-green-200 hover:bg-green-700 hover:shadow-green-300 transition-all flex justify-between px-6">
                    <span>‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤</span>
                    <span id="modal-total-price">0 ‡∏ö‡∏≤‡∏ó</span>
                </button>
            </div>
        </div>
    </div>

    <script>
        // --- 1. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡πÄ‡∏û‡∏¥‡πà‡∏° Category: recommend / promotion) ---
        const menuDB = [
            // --- ‡∏´‡∏°‡∏ß‡∏î‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥ (Recommend) ---
            { 
                id: 1, 
                category: "recommend",
                name: "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏õ‡∏±‡πà‡∏ô (‡πÑ‡∏°‡πà‡πÉ‡∏™‡πà‡∏ô‡∏°)", 
                desc: "‡∏ô‡πâ‡∏≥‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏™‡∏î‡∏õ‡∏±‡πà‡∏ô‡πÅ‡∏ó‡πâ 100% ‡∏´‡∏≠‡∏°‡∏´‡∏ß‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏ú‡∏™‡∏°‡∏ô‡πâ‡∏≥‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°",
                price: 65,
                originalPrice: 75,
                img: "https://images.unsplash.com/photo-1546171753-97d7676e4602?w=400",
                badge: "‡∏Ç‡∏≤‡∏¢‡∏î‡∏µ #1",
                options: [
                    {
                        type: "radio",
                        name: "‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô",
                        choices: [
                            { label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ (‡πÑ‡∏°‡πà‡πÄ‡∏ï‡∏¥‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏•)", price: 0 },
                            { label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢", price: 0 },
                            { label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥", price: 0 }
                        ]
                    }
                ]
            },
            { 
                id: 2, 
                category: "recommend",
                name: "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏õ‡∏±‡πà‡∏ô‡∏ô‡∏°‡∏™‡∏î", 
                desc: "‡∏™‡∏π‡∏ï‡∏£‡∏ô‡∏°‡∏™‡∏î ‡∏´‡∏≠‡∏°‡∏°‡∏±‡∏ô ‡∏ô‡∏±‡∏ß‡∏™‡∏∏‡∏î‡πÜ ‡πÉ‡∏ä‡πâ‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏ô‡πâ‡∏≥‡∏´‡∏≠‡∏°‡∏Ñ‡∏±‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©",
                price: 119, 
                originalPrice: 158,
                img: "https://images.unsplash.com/photo-1595981267035-7b04ca84a82d?w=400",
                options: [
                    {
                        type: "checkbox",
                        name: "‡∏ó‡πá‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ 2)",
                        max: 2, 
                        choices: [
                            { label: "‡∏•‡∏≠‡∏î‡∏ä‡πà‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÄ‡∏à‡∏©", price: 15 },
                            { label: "‡∏ó‡∏±‡∏ö‡∏ó‡∏¥‡∏°‡∏Å‡∏£‡∏≠‡∏ö", price: 15 },
                            { label: "‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏≠‡πà‡∏≠‡∏ô", price: 10 }
                        ]
                    }
                ]
            },
            { 
                id: 3, 
                category: "recommend",
                name: "‡∏ô‡πâ‡∏≥‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏™‡∏î (1 ‡∏•‡∏¥‡∏ï‡∏£)", 
                desc: "‡∏ô‡πâ‡∏≥‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏™‡∏î‡πÅ‡∏ó‡πâ 100% ‡πÑ‡∏°‡πà‡∏ú‡∏™‡∏°‡∏ô‡πâ‡∏≥‡∏ï‡∏≤‡∏• ‡πÅ‡∏ä‡πà‡πÄ‡∏¢‡πá‡∏ô‡πÄ‡∏à‡∏µ‡πä‡∏¢‡∏ö",
                price: 293, 
                originalPrice: 390,
                img: "https://images.unsplash.com/photo-1621506289937-a8e4df240d0b?w=400"
            },

            // --- ‡∏´‡∏°‡∏ß‡∏î‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô (Promotion) - ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡∏°‡πà ---
            {
                id: 4,
                category: "promotion",
                name: "Set ‡∏Ñ‡∏π‡πà‡∏´‡∏π‡∏î‡∏π‡πÇ‡∏≠‡πâ (2 ‡πÅ‡∏Å‡πâ‡∏ß)",
                desc: "‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏õ‡∏±‡πà‡∏ô‡∏ô‡∏°‡∏™‡∏î 2 ‡πÅ‡∏Å‡πâ‡∏ß ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏û‡∏¥‡πÄ‡∏®‡∏©",
                price: 220,
                originalPrice: 238,
                badge: "‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ üî•",
                img: "https://images.unsplash.com/photo-1628519592415-3174241e3d3f?w=400",
                options: [
                    {
                        type: "radio",
                        name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô (‡πÅ‡∏Å‡πâ‡∏ß‡∏ó‡∏µ‡πà 1)",
                        choices: [{ label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥", price: 0 }, { label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢", price: 0 }]
                    },
                    {
                        type: "radio",
                        name: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ß‡∏≤‡∏ô (‡πÅ‡∏Å‡πâ‡∏ß‡∏ó‡∏µ‡πà 2)",
                        choices: [{ label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏õ‡∏Å‡∏ï‡∏¥", price: 0 }, { label: "‡∏´‡∏ß‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢", price: 0 }]
                    }
                ]
            },
            {
                id: 5,
                category: "promotion",
                name: "‡∏ß‡∏∏‡πâ‡∏ô‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏ñ‡πâ‡∏ß‡∏¢‡∏¢‡∏±‡∏Å‡∏©‡πå",
                desc: "‡∏ß‡∏∏‡πâ‡∏ô‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß‡∏ó‡∏≥‡πÄ‡∏≠‡∏á ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡πÅ‡∏ô‡πà‡∏ô ‡∏´‡∏ß‡∏≤‡∏ô‡∏ô‡πâ‡∏≠‡∏¢ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡πâ‡∏≤‡∏ô",
                price: 35,
                originalPrice: 50,
                badge: "Flash Sale",
                img: "https://images.unsplash.com/photo-1598211028080-1a65499c089c?w=400"
            }
        ];

        let cart = []; 
        let map, marker;
        let currentItem = null;
        let currentBasePrice = 0;
        let activeTab = 'recommend'; // Default Tab

        // --- 2. ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏ó‡∏≥‡∏á‡∏≤‡∏ô ---
        document.addEventListener("DOMContentLoaded", () => {
            renderMenu(activeTab); // Render default tab
            initMap();
            updateFooterState('menu');
        });

        // --- 3. ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Tab Switching (Logic ‡πÉ‡∏´‡∏°‡πà) ---
        function switchTab(category) {
            activeTab = category;
            
            // 1. Update UI (Visual)
            document.getElementById('tab-recommend').className = category === 'recommend' 
                ? 'flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-active' 
                : 'flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-inactive hover:text-gray-500';
            
            document.getElementById('tab-promotion').className = category === 'promotion' 
                ? 'flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-active' 
                : 'flex-1 text-center py-3 text-sm font-medium cursor-pointer transition-all duration-300 tab-inactive hover:text-gray-500';

            // 2. Update Heading
            const heading = document.getElementById('menu-heading');
            if(category === 'recommend') heading.innerHTML = '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏¢‡∏≠‡∏î‡∏Æ‡∏¥‡∏ï üî•';
            else heading.innerHTML = '‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏© ‚ö°';

            // 3. Re-render Menu
            renderMenu(category);
        }

        // --- 4. ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤ (Navigation) ---
        function showPage(pageId) {
            document.querySelectorAll('.page-section').forEach(el => el.classList.remove('active-section'));
            document.getElementById('page-' + pageId).classList.add('active-section');
            
            // ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô Tab Category (‡πÇ‡∏ä‡∏ß‡πå‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏´‡∏ô‡πâ‡∏≤ Menu)
            const tabHeader = document.getElementById('category-tabs');
            if(pageId === 'menu') tabHeader.style.display = 'flex';
            else tabHeader.style.display = 'none';

            updateFooterState(pageId);

            if(pageId === 'checkout') {
                setTimeout(() => { map.invalidateSize(); }, 200);
            }
            window.scrollTo(0,0);
        }

        function updateFooterState(pageId) {
            const footer = document.getElementById('sticky-footer');
            const btnCart = document.getElementById('btn-view-cart');
            const btnCheckout = document.getElementById('btn-checkout-group');
            const btnConfirm = document.getElementById('btn-confirm-group');

            footer.classList.remove('hidden');

            btnCart.classList.add('hidden');
            btnCheckout.classList.add('hidden');
            btnConfirm.classList.add('hidden');

            if (pageId === 'menu') {
                if(cart.length === 0) footer.classList.add('hidden');
                else btnCart.classList.remove('hidden');
            } else if (pageId === 'cart') {
                btnCheckout.classList.remove('hidden');
            } else if (pageId === 'checkout') {
                btnConfirm.classList.remove('hidden');
            }
        }

        // --- 5. Render Menu (‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏° Category) ---
        function renderMenu(category) {
            const list = document.getElementById('menu-list');
            
            // Filter ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏≤‡∏° Tab ‡∏ó‡∏µ‡πà‡πÄ‡∏•‡∏∑‡∏≠‡∏Å
            const filteredItems = menuDB.filter(item => item.category === category);

            if (filteredItems.length === 0) {
                list.innerHTML = `<div class="text-center py-10 text-gray-400">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏ô‡∏µ‡πâ</div>`;
                return;
            }

            list.innerHTML = filteredItems.map((item, index) => `
                <div class="bg-white p-5 border-b border-gray-100 flex gap-4 relative hover:bg-gray-50 transition duration-150">
                    <div class="relative shrink-0">
                        <img src="${item.img}" class="w-24 h-24 object-cover rounded-xl shadow-sm">
                        ${item.badge ? `<span class="absolute top-0 left-0 bg-red-500 text-white text-[10px] font-bold px-2 py-0.5 rounded-tl-xl rounded-br-lg shadow-sm">${item.badge}</span>` : ''}
                    </div>

                    <div class="flex-1 flex flex-col justify-between h-24">
                        <div>
                            <h3 class="font-semibold text-gray-800 text-base leading-tight mb-1">${item.name}</h3>
                            <p class="text-xs text-gray-400 font-light line-clamp-2">${item.desc || ''}</p>
                        </div>
                        
                        <div class="flex items-end justify-between">
                            <div class="flex items-baseline gap-2">
                                <span class="text-gray-800 font-bold text-lg">‡∏ø${item.price}</span>
                                ${item.originalPrice ? `<span class="text-gray-300 text-xs line-through">‡∏ø${item.originalPrice}</span>` : ''}
                            </div>
                            <button onclick="addToCart(${item.id})" class="bg-green-50 text-green-600 w-8 h-8 rounded-full flex items-center justify-center hover:bg-green-600 hover:text-white transition shadow-sm active:scale-90">
                                <i class="fa-solid fa-plus text-sm"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // --- 6. Modal & Cart Logic ---
        function addToCart(id) {
            const item = menuDB.find(p => p.id === id);
            if (!item.options || item.options.length === 0) {
                pushToCart(item, [], item.price);
                return;
            }
            openModal(item);
        }

        function openModal(item) {
            currentItem = item;
            currentBasePrice = item.price;
            
            document.getElementById('modal-item-name').innerText = item.name;
            document.getElementById('modal-item-desc').innerText = item.desc || '';
            
            const container = document.getElementById('modal-options');
            container.innerHTML = ''; 

            item.options.forEach((opt, idx) => {
                let html = `<div class="bg-gray-50 border border-gray-100 p-4 rounded-xl">
                    <p class="font-semibold mb-3 text-gray-700 text-sm flex items-center gap-2">
                        ${opt.name} 
                        ${opt.type === 'radio' ? '<span class="text-[10px] text-red-400 bg-red-50 px-1.5 py-0.5 rounded">‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô</span>' : ''}
                    </p>
                    <div class="space-y-3">`;
                
                if (opt.type === 'radio') {
                    opt.choices.forEach((choice, cIdx) => {
                        const isChecked = cIdx === 0 ? 'checked' : ''; 
                        html += `
                            <label class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center">
                                    <input type="radio" name="opt-${idx}" value="${choice.label}" data-price="${choice.price}" ${isChecked} class="option-input text-green-600 focus:ring-green-500 w-4 h-4 border-gray-300" onchange="calculateModalTotal()">
                                    <span class="ml-3 text-sm text-gray-600 group-hover:text-green-700 transition">${choice.label}</span>
                                </div>
                                ${choice.price > 0 ? `<span class="text-xs text-gray-500 font-medium">+${choice.price}</span>` : ''}
                            </label>
                        `;
                    });
                } else if (opt.type === 'checkbox') {
                    opt.choices.forEach((choice) => {
                        html += `
                            <label class="flex items-center justify-between cursor-pointer group">
                                <div class="flex items-center">
                                    <input type="checkbox" name="opt-${idx}" value="${choice.label}" data-price="${choice.price}" class="option-input text-green-600 rounded focus:ring-green-500 w-4 h-4 border-gray-300" onchange="checkLimit(this, ${opt.max}); calculateModalTotal()">
                                    <span class="ml-3 text-sm text-gray-600 group-hover:text-green-700 transition">${choice.label}</span>
                                </div>
                                ${choice.price > 0 ? `<span class="text-xs text-gray-500 font-medium">+${choice.price}</span>` : ''}
                            </label>
                        `;
                    });
                }
                html += `</div></div>`;
                container.innerHTML += html;
            });

            calculateModalTotal();
            document.getElementById('option-modal').classList.remove('hidden');
        }

        function calculateModalTotal() {
            let total = currentBasePrice;
            document.querySelectorAll('.option-input:checked').forEach(input => {
                total += parseInt(input.getAttribute('data-price') || 0);
            });
            document.getElementById('modal-total-price').innerText = `‡∏ø${total}`;
        }

        function checkLimit(checkbox, max) {
            if (!max) return;
            const name = checkbox.name;
            const checkedCount = document.querySelectorAll(`input[name="${name}"]:checked`).length;
            if (checkedCount > max) {
                checkbox.checked = false;
                const Toast = Swal.mixin({ toast: true, position: 'top', showConfirmButton: false, timer: 1500 });
                Toast.fire({ icon: 'info', title: `‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î ${max} ‡∏≠‡∏¢‡πà‡∏≤‡∏á` });
            }
        }

        function closeModal() {
            document.getElementById('option-modal').classList.add('hidden');
        }

        function confirmAddToCart() {
            const selectedOptions = [];
            let totalPrice = currentBasePrice;
            
            let allRequiredSelected = true;
            currentItem.options.forEach((opt, idx) => {
                if (opt.type === 'radio') {
                    if (!document.querySelector(`input[name="opt-${idx}"]:checked`)) allRequiredSelected = false;
                }
            });

            if (!allRequiredSelected) return Swal.fire({ icon: 'warning', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', confirmButtonColor: '#16a34a' });

            document.querySelectorAll('.option-input:checked').forEach(input => {
                selectedOptions.push(input.value);
                totalPrice += parseInt(input.getAttribute('data-price') || 0);
            });

            pushToCart(currentItem, selectedOptions, totalPrice);
            closeModal();
        }

        function pushToCart(item, options, finalPrice) {
            cart.push({ ...item, selectedOptions: options, finalPrice: finalPrice });
            updateCartUI();
            
            // Animation Feedback
            const btn = document.getElementById('btn-view-cart');
            btn.classList.add('scale-95');
            setTimeout(() => btn.classList.remove('scale-95'), 150);
            
            if(document.getElementById('page-menu').classList.contains('active-section')) {
                updateFooterState('menu');
            }
        }

        // --- 7. Cart & UI Updates ---
        function updateCartUI() {
            document.getElementById('footer-count').innerText = cart.length;
            const total = cart.reduce((sum, item) => sum + item.finalPrice, 0);
            document.getElementById('footer-total').innerText = `‡∏ø${total}`;
            document.getElementById('total-price-cart').innerText = `‡∏ø${total}`;
            document.getElementById('subtotal-price').innerText = `‡∏ø${total}`;

            const cartList = document.getElementById('cart-items');
            if(cart.length === 0) {
                cartList.innerHTML = `
                    <div class="text-center py-8 opacity-50">
                        <i class="fa-solid fa-basket-shopping text-4xl mb-2 text-gray-300"></i>
                        <p class="text-sm">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</p>
                    </div>`;
                return;
            }
            
            cartList.innerHTML = cart.map((item, index) => `
                <div class="flex justify-between items-start border-b border-gray-100 pb-4 last:border-0 last:pb-0">
                    <div class="flex gap-3">
                        <div class="bg-green-50 text-green-600 w-6 h-6 rounded-md flex items-center justify-center text-xs font-bold mt-0.5 shadow-sm">${index + 1}</div>
                        <div>
                            <h4 class="font-semibold text-gray-700 text-sm">${item.name}</h4>
                            ${item.selectedOptions && item.selectedOptions.length > 0 
                              ? `<p class="text-xs text-gray-400 mt-1 font-light"> + ${item.selectedOptions.join(', ')}</p>` 
                              : ''}
                            <button onclick="removeFromCart(${index})" class="text-red-400 text-xs mt-2 hover:text-red-600 transition">‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>
                        </div>
                    </div>
                    <span class="font-semibold text-gray-700 text-sm">‡∏ø${item.finalPrice}</span>
                </div>
            `).join('');
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartUI();
            if(cart.length === 0 && document.getElementById('page-menu').classList.contains('active-section')) {
                updateFooterState('menu');
            }
        }

        function goToCheckout() {
            if(cart.length === 0) return Swal.fire({ icon: 'warning', text: '‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤', confirmButtonColor: '#16a34a' });
            
            const total = cart.reduce((sum, item) => sum + item.finalPrice, 0);
            const phone = "0812345678"; 
            
            document.getElementById('qr-image').src = `https://promptpay.io/${phone}/${total}`;
            document.getElementById('final-price-display').innerText = `${total} ‡∏ö‡∏≤‡∏ó`;
            
            showPage('checkout');
        }

        // --- 8. Map & Order ---
        function initMap() {
            const defaultLoc = [13.639484, 100.500646];
            map = L.map('map', { zoomControl: false }).setView(defaultLoc, 16); // ‡∏õ‡∏¥‡∏î Zoom Control ‡πÅ‡∏ö‡∏ö‡πÄ‡∏î‡∏¥‡∏°‡πÉ‡∏´‡πâ‡∏î‡∏π‡∏Ñ‡∏•‡∏µ‡∏ô
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);
            marker = L.marker(defaultLoc).addTo(map);
            document.getElementById('latlong').value = `${defaultLoc[0]},${defaultLoc[1]}`;

            map.on('click', function(e) {
                marker.setLatLng(e.latlng);
                document.getElementById('latlong').value = `${e.latlng.lat},${e.latlng.lng}`;
                map.panTo(e.latlng);
            });
        }

        function confirmOrder() {
            const name = document.getElementById('cust-name').value;
            const phone = document.getElementById('cust-phone').value;
            
            if(!name || !phone) return Swal.fire({ icon: 'warning', text: '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£', confirmButtonColor: '#16a34a' });

            Swal.fire({
                title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...',
                allowOutsideClick: false,
                didOpen: () => Swal.showLoading()
            });

            setTimeout(() => {
                Swal.fire({
                    icon: 'success',
                    title: '‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!',
                    text: '‡∏ó‡∏≤‡∏á‡∏£‡πâ‡∏≤‡∏ô‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß',
                    confirmButtonText: '‡∏ï‡∏Å‡∏•‡∏á',
                    confirmButtonColor: '#16a34a'
                }).then(() => {
                    location.reload(); 
                });
            }, 1500);
        }
    </script>
</body>
</html>
